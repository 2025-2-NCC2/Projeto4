services:
  # Serviço 1: A Base de Dados MySQL
  # O Render irá criar uma base de dados MySQL gratuita para o seu projeto.
  - type: pserv # Private Service (não acessível publicamente, apenas pelo seu backend)
    name: mysql
    runtime: mysql
    plan: free # Plano gratuito do Render
    
  # Serviço 2: A sua Aplicação Backend Node.js
  # O Render irá criar um servidor web para correr o seu ficheiro server.js.
  - type: web # Web Service (acessível publicamente)
    name: backend
    runtime: node
    plan: free # Plano gratuito do Render
    buildCommand: "npm install"
    startCommand: "node server.js"
    envVars:
      # As variáveis de ambiente abaixo ligam o seu backend à sua base de dados automaticamente.
      - key: DB_HOST
        fromService:
          type: pserv
          name: mysql
          property: host
      - key: DB_USER
        fromService:
          type: pserv
          name: mysql
          property: user
      - key: DB_PASSWORD
        fromService:
          type: pserv
          name: mysql
          property: password
      - key: DB_DATABASE
        fromService:
          type: pserv
          name: mysql
          property: database
      - key: DB_PORT
        fromService:
          type: pserv
          name: mysql
          property: port
      # MUITO IMPORTANTE: Substitua o valor abaixo pelo endereço do seu site no Netlify.
      - key: FRONTEND_URL
        value: https://helpful-twilight-78b859.netlify.app/

